import streamlit as st

def component_removal_form():
    st.subheader("Component Removal Entry")

    with st.form("component_form"):
        aircraft_reg = st.text_input("Aircraft Registration")
        ata = st.text_input("ATA Chapter")

        component = st.text_input("Component Name")
        part_number = st.text_input("Part Number")
        serial_number = st.text_input("Serial Number")

        col1, col2 = st.columns(2)
        install_fh = col1.number_input("Install FH", min_value=0.0)
        install_fc = col2.number_input("Install FC", min_value=0)

        col3, col4 = st.columns(2)
        removal_fh = col3.number_input("Removal FH", min_value=0.0)
        removal_fc = col4.number_input("Removal FC", min_value=0)

        removal_reason = st.selectbox(
            "Removal Reason",
            ["Unscheduled", "Scheduled", "Life Limit", "Inspection Finding"]
        )

        station = st.text_input("Station")
        remarks = st.text_area("Remarks")

        submitted = st.form_submit_button("Save Record")

from validation.component_rules import validate_removal_event
from utils.csv_writer import append_removal_event
import streamlit as st

...

if submitted:
    record = {
        "aircraft_reg": aircraft_reg.strip(),
        "component_name": component_name.strip(),
        "part_number": part_number.strip(),
        "serial_number": serial_number.strip(),
        "ata_chapter": ata_chapter.strip(),
        "removal_date": str(removal_date),
        "aircraft_fh": aircraft_fh,
        "aircraft_fc": aircraft_fc,
        "removal_reason": removal_reason,
        "station": station.strip(),
        "deferred_ref": deferred_ref.strip(),
        "work_order": work_order.strip(),
        "technician_id": technician_id.strip(),
        "remarks": remarks.strip()
    }

    errors = validate_removal_event(record)

    if errors:
        for e in errors:
            st.error(e)
    else:
        append_removal_event(record)
        st.success("Removal event saved successfully")
